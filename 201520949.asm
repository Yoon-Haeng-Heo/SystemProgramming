MAIN	RD	STDIN
	STA	F
	LDS	#3
	COMP	ENTER
	JEQ	PRINT
	J	NUM

PRINT	TD	STDOUT
	JEQ	PRINT
	LDX	#0
	LDA	ARR,X
	DIV	#10
	COMP	#0
	JEQ	PRINT2
	STA	ALPHA
	ADD	ZERO
	WD	STDOUT
	LDA	ALPHA
	MUL	#10
	STA	ALPHA
	LDA	ARR,X
	SUB	ALPHA
	ADD	ZERO
	WD	STDOUT
	J	STOP

PRINT2	TD	STDOUT
	JEQ	PRINT2
	LDA	ARR,X
	ADD	ZERO
	WD	STDOUT
	J	STOP

NUM	TD	STDOUT
	JEQ	NUM
	LDA	CNT
	MULR	S,A
	RMO	A,X
	LDA	F
	COMP	ZERO
	JLT	NAN
	SUB	ZERO
	STA	ARR,X
	LDA     CNT
        ADD     ONE
        STA     CNT
	RD	STDIN
	COMP	ZERO
	JLT	NAN
	SUB	ZERO
	STA	B
	LDA	ARR,X
	MUL	TEN
	ADD	B
	STA	ARR,X
	J	MAIN

NAN	TD	STDOUT
	JEQ	NAN
	COMP	SPACE
	JGT	CAL
	J	MAIN

CAL	TD	STDOUT
	JEQ	CAL
	STA	F
	COMP	PLUS
	JEQ	P
	COMP	MINUS
	JEQ	M
	COMP	MULT	
	JEQ	MULTI
	COMP	DIVD
	JEQ	DIVIDE
	J	MAIN

P	SUBR	S,X	
	LDA	ARR,X
	STA	ALPHA
	SUBR	S,X
	LDA	ARR,X
	ADD	ALPHA
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X	
	LDA	CNT
	SUB	#1
	STA	CNT
	LDA	CNT
	MULR	S,A
	RMO	A,X
	J	MAIN

M	SUBR	S,X	
	LDA	ARR,X
	STA	ALPHA
	SUBR	S,X
	LDA	ARR,X
	SUB	ALPHA
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X	
	LDA	CNT
	SUB	#1
	STA	CNT
	LDA	CNT
	MULR	S,A
	RMO	A,X
	J	MAIN

MULTI	SUBR	S,X	
	LDA	ARR,X
	STA	ALPHA
	SUBR	S,X
	LDA	ARR,X
	MUL	ALPHA
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X	
	LDA	CNT
	SUB	#1
	STA	CNT
	LDA	CNT
	MULR	S,A
	RMO	A,X
	J	MAIN

DIVIDE	SUBR	S,X	
	LDA	ARR,X
	STA	ALPHA
	SUBR	S,X
	LDA	ARR,X
	DIV	ALPHA
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X
	ADDR	S,X
	ADDR	S,X
	LDA	ARR,X
	SUBR	S,X
	STA	ARR,X	
	LDA	CNT
	SUB	#1
	STA	CNT
	LDA	CNT
	MULR	S,A
	RMO	A,X
	J	MAIN

STOP	J	STOP

STDIN	BYTE	0
STDOUT	BYTE	1
ENTER	WORD	10
SPACE	WORD	0x20
ZERO	WORD	0x30
PLUS	WORD	0x2B
MINUS	WORD	0x2D
MULT	WORD	0x2A
DIVD	WORD	0x2F
TEN	WORD	0xA
ONE	WORD	1
ALPHA	RESW	1
B	RESW	1
F	RESW	1
CNT	WORD	0
ARR	RESW	100
